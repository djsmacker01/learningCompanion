{% extends "base.html" %}

{% block title %}GCSE Revision Schedule - Learning Companion{% endblock %}

{% block extra_css %}
<style>
    .revision-hero {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 40px 0;
        margin-bottom: 30px;
        border-radius: 10px;
    }

    .intensity-badge {
        padding: 8px 15px;
        border-radius: 20px;
        font-weight: bold;
        font-size: 0.9em;
    }

    .intensity-intensive {
        background: #dc3545;
        color: white;
    }

    .intensity-moderate {
        background: #ffc107;
        color: #212529;
    }

    .intensity-light {
        background: #28a745;
        color: white;
    }

    .revision-card {
        transition: transform 0.2s ease-in-out;
        border-left: 5px solid #667eea;
    }

    .revision-card:hover {
        transform: translateY(-3px);
        box-shadow: 0 8px 15px rgba(0, 0, 0, 0.1);
    }

    .countdown-box {
        background: rgba(255, 255, 255, 0.2);
        padding: 15px;
        border-radius: 10px;
        text-align: center;
    }
</style>
{% endblock %}

{% block content %}
<div class="container-fluid">
    
    <nav aria-label="breadcrumb" class="mb-4">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="{{ url_for('main.dashboard') }}">Dashboard</a></li>
            <li class="breadcrumb-item"><a href="{{ url_for('gcse.gcse_dashboard') }}">GCSE Dashboard</a></li>
            <li class="breadcrumb-item active">Revision Schedule</li>
        </ol>
    </nav>

    
    <div class="revision-hero">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-md-8">
                    <h1><i class="fas fa-calendar-alt me-2"></i>GCSE Revision Schedule</h1>
                    <p class="lead mb-0">Personalized revision plan based on your exam dates and subjects</p>
                </div>
                <div class="col-md-4 text-end">
                    <div class="countdown-box">
                        <h4 class="mb-0">{{ total_exams }}</h4>
                        <small>Upcoming Exams</small>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="container">
        {% if revision_plan %}
        
        <div class="row">
            {% for plan_item in revision_plan %}
            <div class="col-md-6 mb-4">
                <div class="card revision-card h-100">
                    <div class="card-body">
                        <div class="d-flex justify-content-between align-items-start mb-3">
                            <h5 class="card-title mb-0">
                                {{ plan_item.topic.title if plan_item.topic else plan_item.exam.exam_name }}
                            </h5>
                            <span class="intensity-badge intensity-{{ plan_item.intensity }}">
                                {{ plan_item.intensity|title }}
                            </span>
                        </div>

                        
                        <div
                            class="alert alert-{{ 'danger' if plan_item.days_until <= 7 else 'warning' if plan_item.days_until <= 30 else 'info' }} mb-3">
                            <h4 class="mb-0">
                                <i class="fas fa-clock me-2"></i>{{ plan_item.days_until }} days until exam
                            </h4>
                            <small>Exam Date: {{ plan_item.exam.exam_date }}</small>
                        </div>

                        
                        <div class="row text-center mb-3">
                            <div class="col-6">
                                <div class="p-3 bg-light rounded">
                                    <h3 class="mb-0 text-primary">{{ plan_item.sessions_per_week }}</h3>
                                    <small class="text-muted">Sessions/Week</small>
                                </div>
                            </div>
                            <div class="col-6">
                                <div class="p-3 bg-light rounded">
                                    <h3 class="mb-0 text-success">{{ plan_item.recommended_session_length }}</h3>
                                    <small class="text-muted">Minutes/Session</small>
                                </div>
                            </div>
                        </div>

                        
                        <div class="mb-3">
                            <p class="mb-1">
                                <i class="fas fa-graduation-cap me-2"></i>
                                <strong>Exam Board:</strong> {{ plan_item.exam.exam_board if plan_item.exam.exam_board
                                else 'N/A' }}
                            </p>
                            {% if plan_item.exam.specification_code %}
                            <p class="mb-1">
                                <i class="fas fa-file-code me-2"></i>
                                <strong>Specification:</strong> {{ plan_item.exam.specification_code }}
                            </p>
                            {% endif %}
                            {% if plan_item.exam.paper_number %}
                            <p class="mb-1">
                                <i class="fas fa-file-alt me-2"></i>
                                <strong>Paper:</strong> {{ plan_item.exam.paper_number }}
                            </p>
                            {% endif %}
                        </div>

                        
                        <div class="d-grid gap-2">
                            {% if plan_item.topic %}
                            <a href="{{ url_for('sessions.start_session', topic_id=plan_item.topic.id) }}"
                                class="btn btn-primary">
                                <i class="fas fa-play me-2"></i>Start Study Session
                            </a>
                            {% endif %}
                            <a href="{{ url_for('ai_tutor.tutor_dashboard') }}" class="btn btn-outline-info">
                                <i class="fas fa-robot me-2"></i>Generate AI Study Plan
                            </a>
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
        {% else %}
        
        <div class="row">
            <div class="col-12">
                <div class="card border-primary">
                    <div class="card-body text-center py-5">
                        <i class="fas fa-calendar-alt fa-4x text-primary mb-4"></i>
                        <h3>No Revision Schedule Yet</h3>
                        <p class="text-muted mb-4">
                            To get a personalized revision schedule, you need to:
                        </p>
                        <div class="row justify-content-center mb-4">
                            <div class="col-md-8">
                                <ul class="text-start">
                                    <li><strong>Add GCSE subjects</strong> you're studying</li>
                                    <li><strong>Schedule your exams</strong> with dates</li>
                                    <li>The system will automatically create a revision plan based on time available
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <div class="d-flex gap-3 justify-content-center">
                            <a href="{{ url_for('gcse.subjects_list') }}" class="btn btn-primary btn-lg">
                                <i class="fas fa-book me-2"></i>Add Subjects
                            </a>
                            <a href="{{ url_for('gcse.create_exam') }}" class="btn btn-success btn-lg">
                                <i class="fas fa-calendar-plus me-2"></i>Schedule Exams
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        {% endif %}

        
        <div class="row mt-5">
            <div class="col-12">
                <div class="card border-info">
                    <div class="card-header bg-info text-white">
                        <h5 class="mb-0"><i class="fas fa-lightbulb me-2"></i>Revision Tips</h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-4">
                                <h6><i class="fas fa-fire text-danger me-2"></i>Intensive Revision</h6>
                                <p class="small text-muted">7 or fewer days until exam - daily sessions recommended</p>
                            </div>
                            <div class="col-md-4">
                                <h6><i class="fas fa-bolt text-warning me-2"></i>Moderate Revision</h6>
                                <p class="small text-muted">8-30 days until exam - 5 sessions per week recommended</p>
                            </div>
                            <div class="col-md-4">
                                <h6><i class="fas fa-leaf text-success me-2"></i>Light Revision</h6>
                                <p class="small text-muted">30+ days until exam - 3 sessions per week to build
                                    foundation</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}